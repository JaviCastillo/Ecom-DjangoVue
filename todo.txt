Proyect: E-commerce WEbsite With Django and Vue
https://www.youtube.com/watch?v=Yg5zkd9nm6w

- Todo list

- Install and Setup (Django) ================== DONE ======================
    ## virtualenv enviroment_3_8_2  // ## py -m venv enviroment_3_8_2
    ## source enviroment_3_8_2/Scripts/activate
    ## pip install virtualenv
    ## pip install django
    ## pip install django-rest-framework (Rest Framework - Create API in backend)
    ## pip install django-cors-headers   (Security)
    ## pip install djoser                (Authentication, Users, etc)
    ## pip install pillow                (Resize Images and similar)
    ## pip install stripe                (Payments)
    ## django-admin startproject djackets_django
        -->> djackets_django/djackets_django/settings.py

            INSTALLED_APPS = [
                'django.contrib.admin',
                'django.contrib.auth',
                'django.contrib.contenttypes',
                'django.contrib.sessions',
                'django.contrib.messages',
                'django.contrib.staticfiles',

                'rest_framework',
                'rest_framework.authtoken',
                'corsheaders',
                'djoser',
            ]

            CORS_ALLOWED_ORIGINS = [
                "http://localhost:8000"
            ]
            ================== ARREGLIN ======================
            CORS_ALLOW_ALL_ORIGINS = True
            CORS_ALLOW_CREDENTIALS = True

            """ CORS_ALLOWED_ORIGINS = [
                "http://localhost:8000"
            ] """

            CORS_ALLOWED_ORIGIN_REGEXES = [
                'http://localhost:8000',
            ]
            ==================================================


            MIDDLEWARE = [
                'django.middleware.security.SecurityMiddleware',
                'django.contrib.sessions.middleware.SessionMiddleware',

                'corsheaders.middleware.CorsMiddleware',

                'django.middleware.common.CommonMiddleware',
                'django.middleware.csrf.CsrfViewMiddleware',
                'django.contrib.auth.middleware.AuthenticationMiddleware',
                'django.contrib.messages.middleware.MessageMiddleware',
                'django.middleware.clickjacking.XFrameOptionsMiddleware',
            ]
        
        -->> djackets_django/djackets_django/urls.py
            - Remove comment
            -
                from django.contrib import admin
                from django.urls import path, include

                urlpatterns = [
                    path('admin/', admin.site.urls),
                    
                    path('api/v1/', include('djoser.urls')),
                    path('api/v1/', include('djoser.urls.authtoken')),
                ]
        
    create database

        ## python manage.py makemigrations
        ## python manage.py migrate

    test database

        ## python manage.py createsuperuser
            - username: admin
            - email: admin@djackets.com
            - password: SuperCat332
        
        ## python manage.py runserver

        Got to http://127.0.0.1:8000/admin
        Login
        Ctrl+C to break

        ## deactivate
        ## cd ./Djackets



- Insall and Setup (Vue) ================== DONE ======================
    ## npm install -g @vue/cli
    ## vue create djackets_vue
        - Manually select features (Babel - Router - Vuex - CSS)
        - 3.x
        - history mode for router - Yes
        - dart-sass
        - place in dedicated config files
        - Save preset - No
    
    ## cd djackets_vue
    ## npm install axios
    ## npm install bulma

    test
        ## npm run serve
        Go to http://localhost:8080/





- Include FontAwesome ================== DONE ======================
    --> djackets_vue/public/index.html
        <link rel="stylesheet" href="https://cdn.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

- Setup Base Template ================= DONE ===========================
    --> djackets_vue/src/App.vue
            <style>
            "@import '../node_modules/bulma';"
            </style>
            <template> 
                <div id="wrapper">
                    <nav class="navbar is-dark">

                    <div class="navbar-brand">
                        <router-link to="/" class="navbar-item">
                        <strong>Djackets</strong>
                        </router-link>

                        <a class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        </a>
                    </div>

                    <div class="navbar-menu" id="navbar-menu">
                        <div class="navbar-end">

                            <router-link to="/summer" class="navbar-item">Summer</router-link>
                            <router-link to="/winter" class="navbar-item">Winter</router-link>

                        <div class="navbar-item">
                        <div class="buttons">
                            <router-link class="button is-light">Log in</router-link>

                            <router-link class="button is-success">
                                <span class="icon"><i class="fas fa-shopping-cart"></i></span>
                                <span>Cart</span>
                            </router-link>
                        </div>
                        </div>

                        </div>
                    </div>

                    </nav>

                    <section class="section">
                        <router-view/>
                    </section>
                    
                    <footer class="footer">
                        <p class="has-test-centered">Copyright (c) 2021</p>
                    </footer>
                </div>
            </template>

- Create Django App and Models for products ================ DONE ===================
    --> Djackets/djackets_django
    ## source ../env/Scripts/activate
    ## python manage.py startapp product

    --> Djackets/djackets_django/product/models.py
        from django.db import models

        class Category(models.Model):
            name = models.CharField(max_length=255)
            slug = models.SlugField()

            class Meta:
                ordering = ('name',)

            def __str__(self):
                return self.name

            def get_absolute_url(self):
                return f'/{self.slug}/'
    
    --> Djackets/djackets_django/djackets_django/settings.py
        INSTALLED_APPS = [
            ...

            'product'
        ]

        ...

        STATIC_URL = '/static/'
        MEDIA_URL = '/media/'
        MEDIA_ROOT = BASE_DIR / 'media/'
    
    --> Djackets/djackets_django/djackets_django/urls.py
        from django.conf import settings
        from django.conf.urls.static import static
        ...

        urlpatterns = [
            ...
        ] + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
    
    ## python manage.py makemigrations
    ## python manage.py migrate

    --> Djackets/djackets_django/product/models.py
        from io import BytesIO
        from PIL import Image

        from django.core.files import File
        
        ...

        class Product(models.Model):
        category = models.ForeignKey(Category, related_name='products', on_delete=models.CASCADE)
        name = models.CharField(max_length=255)
        slug = models.SlugField()
        description = models.TextField(blank=True, null=True)
        price = models.DecimalField(max_digits=6, decimal_places=2)
        image = models.ImageField(upload_to='uploads/', blank=True, null=True)
        thumbnail = models.ImageField(upload_to='uploads/', blank=True, null=True)
        date_added = models.DateTimeField(auto_now_add=True)

        class Meta:
            ordering = ('-date_added',)

        def __str__(self):
            return self.name

        def get_absolute_url(self):
            return f'/{self.category.slug}/{self.slug}/'

        def get_image(self):
            if self.image:
                return 'http://127.0.0.1:8000' + self.image.url
            return ''
        
        def get_thumbnail(self):
            if self.thumbnail:
                return 'http://127.0.0.1:8000' + self.thumbnail.url
            else:
                if self.image:
                    self.thumbnail = self.make_thumbnail(self.image)
                    self.save()

                    return 'http://127.0.0.1:8000' + self.thumbnail.url
                else:
                    return ''
        
        def make_thumbnail(self, image, size=(300, 200)):
            img = Image.open(image)
            img.convert('RGB')
            img.thumbnail(size)

            thumb_io = BytesIO()
            img.save(thumb_io, 'JPEG', quality=85)

            thumbnail = File(thumb_io, name=image.name) 

            return thumbnail   

    ## python manage.py makemigrations
    ## python manage.py migrate
    ## python manage.py runserver
    

- Create serializer and views for the products ==================== DONE ===========================
    --> Djackets/djackets_django/product/serializers.py (New File)
            from rest_framework import serializers

            from .models import Category, Product

            class ProductSerializer(serializers.ModelSerializer):
                class Meta:
                    model = Product
                    fields = (
                        "id", 
                        "name", 
                        "get_absolute_url", 
                        "description", 
                        "price", 
                        "get_image", 
                        "get_thumbnail"
                    )
                    

    --> Djackets/djackets_django/product/views.py
        from django.shortcuts import render

        from rest_framework.views import APIView
        from rest_framework.response import Response

        from .models import Product
        from .serializers import ProductSerializer

        class LatestProductsList(APIView):
            def get(self, request, format=None):
                products = Product.objects.all()[0:4]
                serializer = ProductSerializer(products, many=True)
                return Response(serializer.data)

    --> Djackets/djackets_django/product/urls.py (New File)
        from django.urls import path, include

        from product import views

        urlpatterns = [
            path('latest-products', views.LatestProductsList.as_view()),
        ]

    --> Djackets/djackets_django/djackets_django/urls.py
        ...
        urlpaterns = [
            ...
            path('api/v1/', include('product.urls')),
        ]
    
    Visit http://127.0.0.1:8000/api/v1/
    Visit http://127.0.0.1:8000/api/v1/latest-products

    --> Djackets/djackets_django/product/admin.py
        from django.contrib import admin

        from .models import Category, Product

        admin.site.register(Category)
        admin.site.register(Product)
    
    Visit http://127.0.0.1:8000/admin/
        Add Category -> Name: Summer, Slug: summer
        Add Another -> Name: Summer, Slug: summer -> Save

        Add Product -> 
            Category: Summer
            Name: Brown Leather
            Slug: brown-Leather
            Description: The desc
            Price: 199
            Image: Djackets/summer1.jpg (internet downloaded)
        -> Save

        Add Product -> 
            Category: Winter
            Name: Warm Jacket
            Slug: warm-jacket
            Description: The desc for this product
            Price: 299
            Image: Djackets/winter1.jpg (internet downloaded)
        -> Save

    Visit http://127.0.0.1:8000/api/v1/latest-products





- Create simple front page (latest products) ==================== DONE (?) ===========================
   
    --> djackets_vue/src/views/Home.vue

<template>
  <div class="home">
    <section class="hero is-medium is-dark mb-6">
      <div class="hero-body has-text-centered">
        <p class="title mb-6">
          Welcome to Djacket
        </p>
        <p class="subtitle">
          The best jacket store online
        </p>
      </div>
    </section>

    <div class="columns is-multiline">
      <div class="column is-12">
        <h2 class="is-size-2 has-text-centered">Latest products</h2>
      </div>
      <div class="column is-3" v-for="product in latestProducts" v-bind:key="product.id">
        <div class="box">
          <figure class="image mb-4">
            <img :src="product.get_thumbnail">
          </figure>

          <h3 class="is-size-4">{{ product.name }}</h3>
          <p class="is-size-6 has-text-grey">${{ product.price }}</p>

          View Details
        </div>
      </div>
    </div>


  </div>
</template>

<script>
import axios from 'axios'

export default {
  name: 'Home',
  data() {
    return {
      latestProducts: []
    }
  },
  components: {
  },
  mounted() {
    this.getLatestProducts()
  },
  methods: {
    getLatestProducts() {
      axios
        .get('/api/v1/latest-products')
        .then(response => {
          this.latestProducts = response.data
        })
        .catch( error => {
          console.log(error)
        })
    }
  }
}
</script>

<style scoped>
  .image {
    margin-top: -1.25rem;
    margin-left: -1.25rem;
    margin-right: -1.25rem;
  }
</style>

-- > django_vue/src/main.js

    import { createApp } from 'vue'
    import App from './App.vue'
    import router from './router'
    import store from './store'
    import axios from 'axios'

    axios.defaults.baseURL = 'http://127.0.0.1:8000'

    require('@/assets/main.scss');

    createApp(App).use(store).use(router, axios).mount('#app')

- View a product ==================== DONE ===========================
    - Create Viewset in Django

        --> djackets_django/product/views.py

            from django.http import Http404
            ...
            class ProductDetail(APIView):
            def get_object(self, category_slug, product_slug):
                try:
                    return Product.objects.filter(category__slug=category_slug).get(slug=product_slug)
                except Product.DoesNotExist:
                    raise Http404
            
            def get(self, request, category_slug, product_slug, format=None):
                product = self.get_object(category_slug, product_slug)
                serializer = ProductSerializer(product)
                return Response(serializer.data)
        
        --> djackets_django/product/urls.py

            ...
            urlpatterns = [
                path('latest-products', views.LatestProductsList.as_view()),
                path('products/<slug:category_slug>/<slug:product_slug>/', views.ProductDetail.as_view()),
            ]

    - Create Vue page for showing product
        --> djackets_vue/src/views/Product.vue (NEW FILE)
            <template>
                <div class="page-product">
                    <div class="column is-multiline">
                        <div class="column is-9">
                            <figure class="image mb-6">
                                <img :src="product.get_image">
                                </figure>
                            <h1 class="title">{{ product.name }}</h1>
                            <p>{{ product.description }}</p>
                        </div>
                        <div class="column is-3">
                            <h2 class="subtitle">Information</h2>
                            <p><strong>Price: </strong>{{ product.price }}</p>
                            <div class="field has-addons mt-6">
                                    <div class="control">
                                    <input type="number" class="input" min="1" v-model="quantity">
                                    </div>
                                    <div class="control">
                                        <a class="button is-dark">Add to cart</a>
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
                </template>

                <script>
                import axios from 'axios'

                export default {
                    name: 'Product',
                    data() {
                        return {
                            product: {},
                            quantity: 1
                        }
                    },
                    mounted() {
                        this.getProduct()
                    },
                    methods: {
                        getProduct() {
                            const category_slug = this.$route.params.category_slug
                            const product_slug = this.$route.params.product_slug

                            axios
                            .get(`/api/v1/products/${category_slug}/${product_slug}`)
                            .then(response => {
                                this.product = response.data
                            })
                            .catch(error => {
                                console.log(error)
                            })
                        }
                    }
                }
                </script>

                <style>

                </style>
            

        --> djackets_vue/src/router/index.js
            ...
            import Product from '../views/Product.vue'
            ...
            const routes = [
                ...
                {
                    path: '/:category_slug/:product_slug/',
                    name: 'Product',
                    component: Product
                }
            ]

    - Add link to detail page

        --> djackets_vue/src/views/Home.vue

            <template>
                ...
                View Details  -> <router-link :to="product.get_absolute_url" class="button-is-dark mt-4">View Details</router-link>
                ...
            </template>

- Settle Opp Vuex / State ==================== DONE ===========================
    ## cd djackets_django
    ## source ../env/Scripts/activate
    ## py manage.py runserver

    ## cd djackets_vue
    ## npm run serve

    --> djackets_vue/src/store/index.js
        ... 
        state: {
            cart: {
                items: [],
            },
            isAuthenticated: false,
            token: '',
            isLoading: false
        },
        ...


- Make it possible to add to Cart ==================== DONE ===========================
    - Add functionality to Vuex
        --> djackets_vue/src/store/index.js
            ... 
            mutations: {
                initializeStore(state) {
                    if (localStorage.getItem('cart')){
                        state.cart = JSON.parse(localStorage.getItem('cart'))
                    } else {
                        localStorage.setItem('cart', JSON.stringify(state.cart))
                    }
                },
                addToCart(state, item) {
                    const exists = state.cart.items.filter(i => i.product.id === item.product.id)

                    if (exist.length) {
                        exists[0].quantity = parseInt(exists[0].quantity) + parseInt(item.quantity)
                    } else {
                        state.cart.items.push(item)
                    }

                    localStorage.setItem('cart', JSON.stringify(state.cart))
                }
            },
            ...


    - Initialize store in app.vue
        --> djackets_vue/src/App.vue
            <template>
            ...
                <span>Cart ({{ cartTotalLength }})</span>
            ...
            </template>
            ...
            <script>
            export default {
                data() {
                    return {
                        showMobileMenu: false,
                        cart: {
                            items: []
                        }
                    }
                },
                beforeCreate() {
                    this.$store.commit('initializeStore')
                },
                mounted() {
                    this.cart = this.$store.state.cart
                },
                computed: {
                    cartTotalLength() {
                        let totalLength = 0

                    for (let i = 0; i < this.cart.items.length; i++) {
                        totalLength += this.cart.items[i].quantity   
                    }

                    return totalLength
                }
            }
            </script>
            ...

    - Add button to product page
        --> djackets_vue/src/views/Product.vue
            <template>
            ...
                <a class="button is-dark" @click="addToCart">Add to cart</a>
            ...
            </template>
            <script>
            ...
                methods: 
                ...
                addToCart() {
                    if(isNaN(this.quantity) || this.quantity < 1){
                        this.quantity = 1
                    }

                    const item = {
                        product: this.product,
                        quantity: this.quantity
                    }

                    this.$store.commit('addToCart', item)
                }
            ...
            </script>


    - Show a toast message
        --> /djackets_vue
            Ctrl+C
            ## npm install bulma-toast
            ## npm run serve
        
        --> djackets_vue/src/views/Product.vue
            <script>
            ...
            import { toast } from 'bulma-toast'    
            ...
            addToCart() {
                ...
                toast({
                    message: 'The product was added to the cart',
                    type: 'is-success',
                    dismissible: true,
                    pauseOnHover: true,
                    duration: 2000,
                    position: 'bottom-right'
                })
                ...
            }
            </script>

- Implement a loading bar ==================== DONE ===========================
    --> djackets_vue/src/store/index.js
        ...
        mutations: {
            ...
            setIsLoading(state, status) {
                state.isLoading = status
            }
            ...
        }
    
    --> djackets_vue/src/views/Product.vue
        <script>
        ...
            async getProduct(){
                this.$store.commit('setIsLoading', true)

                ...
                await axios
                ...

                this.$store.commit('setIsLoading', false)
            }
        ...
        </script>
    
    --> djackets_vue/src/App.vue
        <template>
        ...
            <div class="is-loading-bar has-text-centered" :class="{ 'is-loading' : $store.state.isLoading }">
                <div class="lds-dual-ring"></div>
            </div>

            <section class="section">
        ...
        </template>
        ...
        <style>
        @import '../node_modules/bulma';

        .lds-dual-ring {
            display: inline-block;
            width: 80px;
            height: 80px;
        }

        .lds-dual-ring:after {
            content: " ";
            display: block;
            width: 64px;
            height: 64px;
            margin: 8px;
            border-radius: 50%;
            border: 6px solid #ccc;
            border-color: #ccc transparent #ccc transparent;
            animation: lds-dual-ring 1.2s linear infinite;
        }

        @keyframes lds-dual-ring {
            0% {
                transform: rotate(0deg);
            }

            100%{
                transform: rotate(360deg);
            }
        }

        .is-loading-bar {
            height: 0;
            overflow: hidden;

            -webkit-transition: all 0.3s;
            transition: all 0.3s;

            &.is-loading {
                height: 80px;
            }
        }
        </style>


    --> djackets_vue/src/views/Home.vue
        <script>
        ...
            async getLatestProduct(){
                this.$store.commit('setIsLoading', true)

                ...
                await axios
                ...

                this.$store.commit('setIsLoading', false)
            }
        ...
        </script>

- Set document title (All pages) ==================== DONE ===========================

    --> djackets_vue/src/views/Product.vue
        ...
        await axios
            ...
            .then(response => {
                this.product = response.data

                document.title = this.product.name + ' | Djackets'
            })

    --> djackets_vue/src/views/Home.vue
        ...
        mounted() {
            this.getLatestProducts()

            document.title = 'Home | Djackets'
        },
        ...


- Make it possible to view a category ==================== DONE ===========================
    - Convert the product to a component

    --> djackets_django/product/views.py
        ...
        from .models import Product, Category
        from .serializers import ProductSerializer, CategorySerializer
        ...
        class CategoryDetail(APIView):
            def get_object(self, category_slug):
                try:
                    return Category.objects.get(slug=category_slug)
                except Product.DoesNotExist:
                    raise Http404
            
            def get(self, request, category_slug, format=None):
                category = self.get_object(category_slug)
                serializer = CategorySerializer(category)
                return Response(serializer.data)
    
    --> djackets_django/product/serializers.py
        ...
        class CategorySerializer(serializers.ModelSerializer):
            products = ProductSerializer(many=True)

            class Meta:
                model = Category
                fields = (
                    "id",
                    "name",
                    "get_absolute_url",
                    "products",
                )

    --> djackets_django/product/urls.py
        ...
        urlpatterns = [
            ...
            path('products/<slug:category_slug>', views.CategoryDetail.as_view())
        ]
    

    --> djackets_vue/src/views/Category.vue (NEW FILE)
        <template>
            <div class="page-category">
                <div class="columns is-mutliline">
                    <div class="column is-12">
                        <h2 class="is-size-12 has-text-centered">{{ category.name }}</h2>
                    </div>
                </div>
            </div>
        </template>

        <script>
        import axios from 'axios'
        import { toast } from 'bulma-toast'


        export default {
            name: 'Category',
            data() {
                return {
                    category: {
                        products: []
                    }
                }
            },
            mounted() {
                this.getCategory()
            },
            methods: {
                async getCategory() {
                    const categorySlug = this.$route.params.category_slug

                    this.$store.commit('setIsLoading', true)

                    await axios
                            .get(`/api/v1/products/${categorySlug}/`)
                            .then(response => {
                                this.category = response.data

                                document.title = this.category.name + ' | Djackets'
                            })
                            .catch(error => {
                                console.log(error)

                                toast({
                                    message: 'Something went wrong. Please try again.',
                                    type: 'is-danger',
                                    dismissible: true,
                                    pauseOnHover: true,
                                    duration: 2000,
                                    position: 'bottom-right'
                                })
                            })

                    this.$store.commit('setIsLoading', false)
                }
            }
        }
        </script>

        <style>

        </style>

    --> djackets_vue/src/router/index.js
        ...
        import Category from '../views/Category.vue'
        ...
        ,
        {
            path: '/:category_slug',
            name: 'Category',
            component: Category
        }
    
    --> djackets_vue/src/views/Category.vue
        ...
            <div class="column is-12">
                <h2 class="is-size-2 has-text-centered">{{ category.name }}</h2>
            </div>
        </div>

        <div class="columns is-mutliline">
          <div class="column is-3" v-for="product in category.products" v-bind:key="product.id">
               <div class="box">
                  <figure class="image mb-4">
                    <img :src="product.get_thumbnail">
                  </figure>

                  <h3 class="is-size-4">{{ product.name }}</h3>
                  <p class="is-size-6 has-text-grey">${{ product.price }}</p>

                  <router-link :to="product.get_absolute_url" class="button is-dark mt-4">View Details</router-link>
               </div>
          </div>
        ...

    --> djackets_vue/src/components/ProductBox.vue (NEW FILE)
        <template>
            <div class="column is-3">
                <div class="box">
                    <figure class="image mb-4">
                        <img :src="product.get_thumbnail">
                    </figure>

                    <h3 class="is-size-4">{{ product.name }}</h3>
                    <p class="is-size-6 has-text-grey">${{ product.price }}</p>

                    <router-link :to="product.get_absolute_url" class="button is-dark mt-4">View Details</router-link>
                </div>
            </div>
        </template>

        <script>
        export default {
            name: 'ProductBox',
            props: {
                product: Object
            }
        }
        </script>
    
        <style scoped>
            .image {
                margin-top: -1.25rem;
                margin-left: -1.25rem;
                margin-right: -1.25rem;
            }
        </style>


    --> djackets_vue/src/views/Home.vue
        <template>
            ...
            <div class="columns is-multiline">
                <div class="column is-12">
                    <h2 class="is-size-2 has-text-centered">Latest products</h2>
                </div>

                <ProductBox v-for="product in latestProducts" :key="product.id" :product="product" />     
            </div>
        </template>
        <script>
            ...
            import ProductBox from '@/components/ProductBox'
            ...
            components: {
                ProductBox
            },
            ...
        </script>

        ** remove <style>
    
    --> djackets_vue/src/views/Category.vue
        <template>
            ...
            <div class="columns is-mutliline">
                <ProductBox v-for="product in category.products" :key="product.id" :product="product"/>
            </div>
            ...
        </template>
        <script>
            ...
            import ProductBox from '@/components/ProductBox'
            ...
            components: {
                ProductBox
            },
            ...
            watch: {
                $route(to, from) {
                    if (to.name === 'Category') {
                        this.getCategory()
                    }
                }
            },
        </script>

- Add search functionality ==================== DONE ===========================

    --> djackets_django/product/views.py
        from django.db.models import Q
        ...
        from rest_framework.decorators import api_view
        ...
        @api_view(['POST'])
        def search(request):
            query = request.data.get('query', '')

            if query:
                products = Product.objects.filter(Q(name__icontains=query) | Q(description__icontains=query))
                serializer = ProductSerializer(products, many=True)
                return Response({"products": []})
    
    --> djackets_django/product/urls.py
        ...
        urlpaterns = [
            path('latest-products/', views.LatestProductsList.as_view()),
            path('products/search/', views.search),
            ...
        ]
    
    --> djackets_vue/src/App.vue
        ...
        <div class="navbar-menu" id="navbar-menu" v-bind:class="{ 'is-active' : showMobileMenu }">

        div.navbar-start>
            div.navbar-item>
                form:get(action="/search")>
                    div.field.has-addons>
                        (div.control>input.input(placeholder="What are you looking for?" name="query"))+
                        (div.control>button.button.is-success>span.icon>i.fas.fa-search)

        <div class="navbar-end">
        ...
    
    --> djackets_vue/src/views/Search.vue (NEW FILE)
        <template>
            <div class="page-search">
                <div class="columns is-multiline">
                    <div class="column is-12">
                        <h1 class="title">Search</h1>
                        <h2 class="is-size-5 has-text-grey">Search term: "{{ query }}"</h2>
                    </div>

                    <ProductBox 
                        v-for="product in products"
                        v-bind:key="product.id"
                        v-bind:product="product" />
                </div>
            </div>
        </template>

        <script>
        import axios from 'axios'
        import ProductBox from '@/components/ProductBox.vue'

        export default {
            name: 'Search',
            components: {
                ProductBox
            },
            data() {
                return {
                    products: [],
                    query: ''
                }
            },
            mounted() {
                document.title = 'Search | Djackets'

                let uri = window.location.search.substring(1)
                let params = new URLSearchParams(uri)

                if (params.get('query')) {
                    this.query = params.get('query')

                    this.performSearch()
                }
            },
            methods: {
                async performSearch(){
                    this.$store.commit('setIsLoading', true)

                    await axios
                        .post('/api/v1/products/search/', {'query': this.query})
                        .then(response => {
                            this.products = response.data
                        })
                        .catch(error => {
                            console.log(error)
                        })
                        
                    this.$store.commit('setIsLoading', false)
                }
            }
        }
        </script>
    
    --> djackets_vue/src/router/index.js
        ...
        import Search from '../views/Search.vue'
        ...
        {
            path: '/search',
            name: 'Search',
            component: Search
        },

- View Cart ==================== DONE ===========================
    - A cart item should be a component

     --> djackets_vue/src/router/index.js
        ...
        import Cart from '../views/Cart.vue'
        ...
        {
            path: '/cart',
            name: 'Cart',
            component: Cart
        },


    --> djackets_vue/src/views/Cart.vue (NEW FILE)
        <template>
            <div class="page-cart">
                <div class="columns is-multiline">
                    <div class="column is-12">
                        <h1 class="title">Cart</h1>
                    </div>

                    <div class="column is-12 box">
                        <table class="table is-fullwidth" v-if="cartTotalLength">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Price</th>
                                    <th>Quantity</th>
                                    <th>Total</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <CartItem 
                                    v-for="item in cart.items"
                                    :key="item.product.id"
                                    :initialItem="item"/>
                            </tbody>
                        </table>

                        <p v-else>You don't have any products in your cart...</p>
                    </div>

                    <div class="column is-12 box">
                        <h2 class="subtitle">Summary</h2>
                        <strong>${{  cartTotalPrice.toFixed(2) }}</strong>, {{ cartTotalLength }} items
                        <hr>
                        <router-link to="/cart/checkout" class="button is-dark">Proceed to checkout</router-link>
                    </div>
                </div>
            </div>
        </template>

        <script>
        import axios from 'axios'
        import CartItem from '@/components/CartItem.vue'

        export default {
            name: 'Cart',
            components: {
                CartItem
            },
            data(){
                return {
                    cart: {
                        items: []
                    }
                }
            },
            mounted() {
                this.cart = this.$store.state.cart
            },
            computed: {
                cartTotalLength() {
                    return this.cart.items.reduce((acc, curVal) => {
                        return acc += curVal.quantity
                    }, 0)
                },
                cartTotalPrice() {
                    return this.cart.items.reduce((acc, curVal) => {
                        return acc += curVal.product.price * curVal.quantity
                    }, 0)
                },
            }
        }
        </script>


    --> djackets_vue/src/components/CartItem.vue (NEW FILE)
        <template>
            <tr>
                <td>
                    <router-link :to="item.product.get_absolute_url">{{ item.product.name }}</router-link>
                </td>
                <td>${{ item.product.price }}</td>
                <td>
                    {{ item.quantity }}
                    </td>
                <td>${{ getItemTotal(item).toFixed(2) }}</td>
                <td><button class="delete"></button></td>
            </tr>
        </template>

        <script>
        export default {
            name: 'CartItem',
            props: {
                initialItem: Object
            },
            data(){
                return {
                    item: this.initialItem
                }
            },
            methods: {
                getItemTotal(item) {
                    return item.quantity * item.product.price
                }
            }
        }
        </script>

- Change contents of cart ==================== DONE ===========================
    - Increment / Decrement content
    - Remove from cart

        --> djackets_vue/src/views/Cart.vue
            ...
            <tbody>
                <CartItem 
                v-for="item in cart.items"
                :key="item.product.id"
                :initialItem="item"
                v-on:removeFromCart="removeFromCart" />
            </tbody>
            ...
            mounted() {...},
            methods: {
                removeFromCart(item){
                    this.cart.items = this.cart.items.filter(i => i.product.id !== item.product.id)
                }
            },
            computed: {
            ...

        --> djackets_vue/src/components/CartItem.vue
            ...
            <td>
                {{ item.quantity }}
                <a @click="decrementQuantity(item)">-</a>
                <a @click="incrementQuantity(item)">+</a>
            </td>
            <td>${{ getItemTotal(item).toFixed(2) }}</td>
            <td><button class="delete" @click="removeFromCart(item)"></button></td>
            ...
            methods: {
                ...
                decrementQuantity(item){
                    item.quantity -= 1

                    if(item.quantity === 0) {
                        this.$emit('removeFromCart', item)
                    }

                    this.updateCart()
                },
                incrementQuantity(item){
                    item.quantity += 1

                    this.updateCart()
                },
                updateCart() {
                    localStorage.setItem('cart', JSON.stringify(this.$store.state.cart))
                },
                removeFromCart(item) {
                    this.$emit('removeFromCart', item)

                    this.updateCart()
                }
            }
            ...

- Make it possible to sign up ==================== DONE ===========================

    --> djackets_vue/src/views/SignUp.vue (NEW FILE)

        <template>
            <div class="page-sign-up">
                <div class="columns">
                    <div class="column is-4 is-offset-4">
                        <h1 class="title">Sign Up</h1>

                        <form @submit.prevent="submitForm">
                            <div class="field">
                                <label>Username</label>
                                <div class="control">
                                    <input type="text" class="input" v-model="username">
                                </div>
                            </div>

                            <div class="field">
                                <label>Password</label>
                                <div class="control">
                                    <input type="password" class="input" v-model="password">
                                </div>
                            </div>

                            <div class="field">
                                <label>Repeat password</label>
                                <div class="control">
                                    <input type="password" class="input" v-model="password2">
                                </div>
                            </div>

                            <div class="notification is-danger" v-if="errors.length">
                                <p v-for="error in errors" :key="error">{{ error }}</p>
                            </div>

                            <div class="field">
                                <div class="control">
                                    <button class="button is-dark">Sign up</button>
                                </div>
                            </div>

                            <hr>
                            Or <router-link to="/log-in">click here</router-link> to log in!
                        </form>
                    </div>
                </div>
            </div>
        </template>

        <script>
        import axios from 'axios'
        import { toast } from 'bulma-toast'

        export default {
            name: 'SignUp',
            data() {
                return {
                    username: '',
                    password: '',
                    password2: '',
                    errors: []
                }
            },
            methods: {
                submitForm() {
                    this.errors = []

                    if (this.username === '') {
                        this.errors.push('The username is missing')
                    }

                    if (this.password === '') {
                        this.errors.push('The password is too short')
                    }

                    if (this.password !== this.password2) {
                        this.errors.push('The passwords doesn\'t match')
                    }

                    if (!this.errors.length) {
                        const formData = {
                            username: this.username,
                            password: this.password
                        }

                        axios
                            .post("/api/v1/users/", formData)
                            .then(response => {
                                toast({
                                    message: 'Account created, please log in!', 
                                    type: 'is-success', 
                                    dismissible: true, 
                                    pauseOnHover: true, 
                                    duration: 2000, 
                                    position: 'bottom-right'
                                })

                                this.$router.push('/log-in')
                            })
                            .catch(error => {
                                if (error.response) {
                                    for (const property in error.response.data) {
                                        this.errors.push(`${property}: ${error.response.data[property]}`) 
                                    }

                                    console.log(JSON.stringify(error.response.data))
                                } else if (error.message) {
                                    this.errors.push('Something went wrong. Please try again')

                                    console.log(JSON.stringify(error))
                                }
                            })
                    }
                }
            }
        }
        </script>

    --> djackets_vue/src/router/index.js
    ...
    import SignUp from '../views/SignUp.vue'
    ...
    {
        path: '/sign-up',
        name: 'SignUp',
        component: SignUp
    },
    ...

- Make it possible to log in ==================== DONE ===========================

    --> djackets_vue/src/store/index.js
        ...
        mutations: {
            initializeStore(state) {
        ...
        if (localStorage.getItem('token')){
            state.token = localStorage.getItem('token')
        } else {
            state.token = ''
            state.isAuthenticated = false
        }
        ...
        setIsLoading(state, status) {...},
        setToken(state, token) {
            state.token = token
            state.isAuthenticated = true
        },
        removeToken(state) {
            state.token = ''
            state.isAuthenticated = false
        }
    
    --> djackets_vue/src/App.vue
        ...
        beforeCreate() {
            this.$store.commit('initializeStore')

            const token = this.$store.state.token

            if (token) {
                axios.defaults.headers.common['Authorization'] = "Token " + token
            } else {
                axios.defaults.headers.common['Authorization'] = ""  
            }
        },
        ...

    --> djackets_vue/src/router/index.js
        ...
        import LogIn from '../views/LogIn.vue'
        ...
        {
            path: '/log-in',
            name: 'LogIn',
            component: LogIn
        },
        ...

    --> djackets_vue/src/views/LogIn.vue (NEW FILE)
        <template>
            <div class="page-log-in">
                <div class="columns">
                    <div class="column is-4 is-offset-4">
                        <h1 class="title">Log In</h1>

                        <form @submit.prevent="submitForm">
                            <div class="field">
                                <label>Username</label>
                                <div class="control">
                                    <input type="text" class="input" v-model="username">
                                </div>
                            </div>

                            <div class="field">
                                <label>Password</label>
                                <div class="control">
                                    <input type="password" class="input" v-model="password">
                                </div>
                            </div>

                            <div class="notification is-danger" v-if="errors.length">
                                <p v-for="error in errors" :key="error">{{ error }}</p>
                            </div>

                            <div class="field">
                                <div class="control">
                                    <button class="button is-dark">Log in</button>
                                </div>
                            </div>

                            <hr>
                            Or <router-link to="/sign-up">click here</router-link> to sign up!
                        </form>
                    </div>
                </div>
            </div>
        </template>

        <script>
        import axios from 'axios'
        import { toast } from 'bulma-toast'

        export default {
            name: 'LogIn',
            data() {
                return {
                    username: '',
                    password: '',
                    errors: []
                }
            },
            mounted() {
                document.title = "Log In | Djackets"
            },
            methods: {
                async submitForm() {
                    axios.defaults.headers.common['Authorization'] = ""  

                    localStorage.removeItem("token")

                    const formData = {
                        username: this.username,
                        password: this.password
                    }

                    await axios
                        .post('/api/v1/token/login/', formData)
                        .then(response => {
                            const token = response.data.auth_token

                            this.$store.commit('setToken', token)

                            axios.defaults.headers.common['Authorization'] = "Token " + token

                            localStorage.setItem("token", token)

                            const toPath = this.$route.query.to || '/cart'

                            this.$router.push(toPath)
                        })
                        .catch(error => {
                            if (error.response) {
                                for (const property in error.response.data) {
                                    this.errors.push(`${property}: ${error.response.data[property]}`)
                                }
                            } else {
                                this.errors.push('Something went wrong. Please try again')

                                console.log(JSON.stringify(error))
                            }
                        })
                }
            }
        }
        </script>

    

- Create a simple my account system ==================== DONE ===========================

    --> djackets_vue/src/views/MyAccount.vue (NEW FILE)
        <template>
            <div class="page-my-account">
                <div class="columns is-multiline">
                    <div class="column is-12">
                        <h1 class="title">My Account</h1>
                    </div>
                    <div class="column is-12">
                        <button @click="logout()" class="button is-danger">Log out</button>
                    </div>
                </div>
            </div>
        </template>

        <script>
        import axios from 'axios'

        export default {
            name: 'MyAccount',
            methods: {
                logout() {
                    axios.defaults.headers.common["Authorization"] = ""

                    localStorage.removeItem("token")
                    localStorage.removeItem("username")
                    localStorage.removeItem("userid")

                    this.$store.commit('removeToken')


                    this.$router.push('/')
                }
            },
            mounted() {
                document.title = 'My Account | Djackets'
            }
        }
        </script>


    --> djackets_vue/src/router/index.js
        import { createRouter, createWebHistory } from 'vue-router'
        import store from '../store'
        ...
        import MyAccount from '../views/MyAccount.vue'
        ...
        {
            path: '/my-account',
            name: 'MyAccount',
            component: MyAccount,
            meta: {
                requiredLogin: true
            }
        },
        ...
        const router = createRouter({
            history: createWebHistory(process.env.BASE_URL),
            routes
        })

        router.beforeEach((to, from, next) => {
            if (to.matched.some(record => record.meta.requireLogin) && !store.state.isAuthenticated) {
                next({ name: 'LogIn', query: { to: to.path } })
            } else {

            }
        })
    

    --> djackets_vue/src/App.vue
        ...
        <div class="buttons">
            <template v-if="$store.state.isAuthenticated">
                <router-link to="/my-account" class="button is-light">My account</router-link>
            </template>

            <template v-else>
                <router-link to="/log-in" class="button is-light">Log in</router-link>
            </template>
        ...

- Proceed to Checkout (Authentification) ==================== DONE ===========================

    --> djackets_vue/src/views/Checkout.vue (NEW FILE)
        <template>
            <div class="page-checkout">
                <div class="columns is-multiline">
                    <div class="column is-12">
                        <h1 class="title">Checkout</h1>
                    </div>

                    <div class="column is-12">
                        <table class="table is-fullwidth">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Price</th>
                                    <th>Quaintity</th>
                                    <th>Total</th>
                                </tr>
                            </thead>

                            <tbody>
                                <tr v-for="item in cart.items" :key="item.product.id">
                                    <td>{{ item.product.name }}</td>
                                    <td>${{ item.product.price }}</td>
                                    <td>{{ item.quantity }}</td>
                                    <td>${{ getItemTotal(item).toFixed(2) }}</td>
                                </tr>
                            </tbody>

                            <tfoot>
                                <tr>
                                    <td colspan="2">Total</td>
                                    <td>{{ cartTotalLength }}</td>
                                    <td>${{ cartTotalPrice.toFixed(2) }}</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>

                    <div class="column is-12 box">
                        <h2 class="subtitle">Shipping details</h2>

                        <p class="has-text-grey mb-4">* All fields are required</p>

                        <div class="columns is-multiline">

                            <div class="column is-6">
                                <div class="field">
                                    <label>First Name *</label>
                                    <div class="control">
                                        <input type="text" class="input" v-model="first_name">
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Last Name *</label>
                                    <div class="control">
                                        <input type="text" class="input" v-model="last_name">
                                    </div>
                                </div>
                                <div class="field">
                                    <label>E-mail *</label>
                                    <div class="control">
                                        <input type="email" class="input" v-model="email">
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Phone Number *</label>
                                    <div class="control">
                                        <input type="text" class="input" v-model="phone">
                                    </div>
                                </div>
                            </div>

                            <div class="column is-6">
                                <div class="field">
                                    <label>Address *</label>
                                    <div class="control">
                                        <input type="text" class="input" v-model="address">
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Zip code *</label>
                                    <div class="control">
                                        <input type="text" class="input" v-model="zipcode">
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Place *</label>
                                    <div class="control">
                                        <input type="email" class="input" v-model="place">
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="notification is-danger mt-4" v-if="errors.length">
                            <p v-for="error in errors" :key="error">{{ error }}</p>
                        </div>

                        <hr>

                        <div id="card-element" class="mb-5"></div>

                        <template v-if="cartTotalLength">
                            <hr>

                            <button class="button is-dark" @click="submitForm">Pay with Stripe</button>
                        </template>
                    </div>

                </div>
            </div>
        </template>

        <script>
        import axios from 'axios'

        export default {
            name: 'Checkout',
            data() {
                return {
                    cart: {
                        items: []
                    },
                    stripe: {},
                    card: {}, 
                    first_name: '', 
                    last_name: '', 
                    email: '', 
                    phone: '', 
                    address: '', 
                    zipcode: '', 
                    place: '', 
                    errors: []
                }
            },
            mounted() {
                document.title = 'Checkout | Djackets'

                this.cart = this.$store.state.cart
            },
            methods: {
                getItemTotal(item) {
                    return item.quantity * item.product.price
                },
                submitForm(){
                    this.errors = []

                    if (this.first_name === '') {
                        this.errors.push('The first name field is missing!')
                    }

                    if (this.last_name === '') {
                        this.errors.push('The last name field is missing!')
                    }

                    if (this.email === '') {
                        this.errors.push('The email field is missing!')
                    }

                    if (this.phone === '') {
                        this.errors.push('The phone field is missing!')
                    }

                    if (this.address === '') {
                        this.errors.push('The address field is missing!')
                    }

                    if (this.zipcode === '') {
                        this.errors.push('The zip code field is missing!')
                    }

                    if (this.place === '') {
                        this.errors.push('The place field is missing!')
                    }
                }
            },
            computed: {
                cartTotalPrice() {
                    return this.cart.items.reduce((acc, curVal) => {
                        return acc += curVal.product.price * curVal.quantity
                    }, 0)
                },
                cartTotalLength() {
                    return this.cart.items.reduce((acc, curVal) => {
                        return acc += curVal.quantity
                    }, 0)
                }
            }
        }
        </script>

    --> djackets_vue/src/router/index.js
        ...
        import Checkout from '../views/Checkout.vue'
        ...
        {
            path: '/cart/checkout',
            name: 'Checkout',
            component: Checkout,
            meta: {
            requiredLogin: true
            }
        },
        ...


- Create a simple success page ==================== DONE ===========================

    --> djackets_vue/src/views/Success.vue (NEW FILE)
        <template>
            <div class="page-success">
                <div class="columns is-multiline">
                    <div class="column is-12">
                        <h1 class="title">Thank You!</h1>

                        <p>Your order will be processed within 48 hours</p>
                    </div>
                </div>
            </div>
        </template>

        <script>
        export default {
            name: 'Success',
            mounted() {
                document.title = 'Success | Djackets'
            },
        }
        </script>


    --> djackets_vue/src/router/index.js
        ...
        import Success from '../views/Success.vue'
        ...
        {
            path: '/cart/success',
            name: 'Success',
            component: Success
        },
        ...

    -----> go to stripe.com and get API Key *** ---> https://dashboard.stripe.com/apikeys

    --> djackets_django/djackets_django/settings.py
        ...
        ALLOWED_HOSTS = []

        STRIPE_SECRET_KEY = ***(APIKey de Stripe)
        ...
    
    ----- >### Python terminal
        Ctrl+c (stop server)
        ##python manage.py startapp order

    --> djackets_django/djackets_django/settings.py
        ...
        INSTALLED_APPS = [
            ...
            'product',
            'order'
        ]
        ...
    
    --> djackets_django/order/models.py
        from django.contrib.auth.models import User
        from django.db import models

        from product.models import Product

        class Order(models.Model):
            user = models.ForeignKey(User, related_name='orders', on_delete=models.CASCADE)
            first_name = models.CharField(max_length=100)
            last_name = models.CharField(max_length=100)
            email = models.CharField(max_length=100)
            address = models.CharField(max_length=100)
            zipcode = models.CharField(max_length=100)
            place = models.CharField(max_length=100)
            phone = models.CharField(max_length=100)
            created_at = models.DateTimeField(auto_now_add=True)
            paid_amount = models.DecimalField(max_digits=8, decimal_places=2, blank=True, null=True)
            stripe_token = models.CharField(max_length=100)

            class Meta:
                ordering = ['-created_at',]
            
            def __str__(self):
                return self.first_name

        class OrderItem(models.Model):
            order = models.ForeignKey(Order, related_name='items', on_delete=models.CASCADE)
            product = models.ForeignKey(Product, related_name='items', on_delete=models.CASCADE)
            price = models.DecimalField(max_digits=8, decimal_places=2)
            quantity = models.IntegerField(default=1)

            def __str__(self):
                return '%s' % self.id

    ----- >### Python terminal
        ## python manage.py makemigrations
        ## python manage.py migrate
        ## python manage.py runserver
    
    --> djackets_django/order/views.py

        import rest_framework
        import stripe

        from django.conf import settings
        from django.contrib.auth.models import User
        from django.http import Http404
        from django.shortcuts import render

        from rest_framework import status, authentication, permissions
        from rest_framework.decorators import api_view, authentication_classes, permission_classes
        from rest_framework.views import APIView
        from rest_framework.response import Response

        from .models import Order, OrderItem
        from .serializers import OrderSerializer

        @api_view(['POST'])
        @authentication_classes([authentication.TokenAuthentication])
        @permission_classes([permissions.IsAuthenticated])
        def checkout(request):
            serializer = OrderSerializer(data=request.data)

            if serializer.is_valid():
                stripe.api_key = settings.STRIPE_SECRET_KEY
                paid_amount = sum(item.get('quantity') * item.get('product').price for item in serializer.validated_data['items'])

                try:
                    charge = stripe.Charge.create(
                        amount=int(paid_amount * 100),
                        currency='USD',
                        description='Charge from Djackets',
                        source=serializer.validated_data['stripe_token']
                    )

                    serializer.save(user=request.user, paid_amount=paid_amount)

                    return Response(serializer.data, status=status.HTTP_201_CREATED)
                except Exception as e:
                    print(e)
                    return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
            
            return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    --> djackets_django/order/urls.py (NEW FILE)

        from django.urls import path

        from order import views

        urlpatterns = [
            path('checkout/', views.checkout)
        ]
    
    --> djackets_django/djackets_django/urls.py
        ...
        urlpatterns = [
            ...
            path('api/v1/', include('order.urls')),
        ]
        ...


    --> djackets_django/order/serializers.py (NEW FILE)

        from django.db.models import fields
        from rest_framework import serializers

        from .models import Order, OrderItem

        from product.serializers import ProductSerializer

        class OrderItemSerializer(serializers.ModelSerializer):
            class Meta:
                model = OrderItem
                fields = (
                    "price",
                    "product",
                    "quantity",
                )

        class OrderSerializer(serializers.ModelSerializer):
            items = OrderItemSerializer(many=True)

            class Meta:
                model = Order
                fields = (
                    "id",
                    "first_name",
                    "last_name",
                    "email",
                    "address",
                    "zipcode",
                    "place",
                    "phone",
                    "stripe_token",
                    "items",
                )
            
            def create(self, validated_data):
                items_data = validated_data.pop('items')
                order = Order.objects.create(**validated_data)

                for item_data in items_data:
                    OrderItem.objects.create(order=order, **item_data)

                return order
    

    --> djackets_vue/src/views/Checkout.vue
        ...
        mounted() {
            document.title = 'Checkout | Djackets'

            this.cart = this.$store.state.cart

            if(this.cartTotalLength > 0) {
                this.stripe = Stripe('***(APIKey publica de Stripe)')
                const elements = this.stripe.elements()
                this.card = elements.create('card', { hidePostalCode: true })

                this.card.mount('#card-element')
            }
        },
        ...
        methods: {
            ...
            submitForm() {
                ...
               if (!this.errors.length) {
                this.$stroe.commit('setIsLoading', true)

                this.stripe.createdToken(this.card).then(result => {
                    if (result.error) {
                        this.$store.commit('setIsLoading', false)

                        this.errors.push('Something went wrong with Stripe. Please try again')

                        console.log(result.error.message)
                    } else {
                        this.stripeTokenHandler(result.token)
                    }
                })
            }
            async stripeTokenHandler(token){
                const items = []

                for (let i = 0; i < this.cart.items.length; i++) {
                    const item = this.cart.items[i];
                    const obj = {
                        product: item.product.id,
                        quantity: item.quantity,
                        price: item.product.price * item.quantity
                    }

                    items.push(obj)
                }

                const data = {
                    'first_name': this.first_name,
                    'last_name': this.last_name,
                    'email': this.email,
                    'address': this.address,
                    'zipcode': this.zipcode,
                    'place': this.place,
                    'phone': this.phone,
                    'items': items,
                    'stripe_token': token.id
                }

                await axios
                    .post('/api/v1/checkout', data)
                    .then(response => {
                        this.$store.commit('clearCart')
                        this.$router.push('/cart/success')
                    })
                    .catch(error => {
                        this.errors.push('Something went wrong. Please try again')

                        console.log(error)
                    })

                this.$store.commit('setIsLoading', false)
            }
        },
        ...

    --> djackets_vue/public/index.html
        ...
                <script src="https://js.stripe.com/v3"></script>
        </head>    
        ... 


    --> djackets_vue/src/store/index.js
         mutations: {   
            ...
            clearCart(state) {
            state.cart = { items: [] }

            localStorage.setItem('cart', JSON.stringify(state.cart))
            }
         }
    

    --> djackets_django/order/admin.py
        from django.contrib import admin

        from .models import Order, OrderItem

        admin.site.register(Order)



    ---> Place order with card (4242 4242 4242 4242 - 04/24 - 123)
    ---> Go to 127.0.0.1:8000/admin/order/order  and check order made

- Show my orders on the my account page ==================== DONE ===========================

        ---> djackets_django/order/serializer.py
            ...
            from product.serializers import ProductSerializer

            class MyOrderItemSerializer(serializers.ModelSerializer):
                product = ProductSerializer()

                class Meta:
                    model = OrderItem
                    fields = (
                        "price",
                        "product",
                        "quantity",
                    )

            class MyOrderSerializer(serializers.ModelSerializer):
                items = MyOrderItemSerializer(many=True)

                class Meta:
                    model = Order
                    fields = (
                        "id",
                        "first_name",
                        "last_name",
                        "email",
                        "address",
                        "zipcode",
                        "place",
                        "phone",
                        "stripe_token",
                        "items",
                        "paid_amount",
                    )
            ...
        

        ---> djackets_django/order/views.py
            ...
            from .serializers import OrderSerializer, MyOrderSerializer
            ...
            class OrdersList(APIView):
                authentication_classes = [authentication.TokenAuthentication]
                permission_classes = [permissions.IsAuthenticated]

                def get(self, request, format=None):
                    orders = Order.objects.filter(user=request.user)
                    serializer = MyOrderSerializer(orders, many=True)
                    return Response(serializer.data)
            ...
        

        ---> djackets_django/order/urls.py
            ...
            urlpatterns = [
                path('checkout/', views.checkout),
                path('orders/', views.OrdersList.as_view()),
            ]
        

        ---> djackets_vue\src\views\MyAccount.vue
            ...
            <div class="column is-12">
                <button @click="logout()" class="button is-danger">Log out</button>
            </div>

            <hr>

            <div class="column is-12">
                <h2 class="subtitle">My orders</h2>
                <OrderSummary v-for="order in orders" :key="order.id" :order="order" />
            </div>
            ...
            import OrderSummary from '@/components/OrderSummary.vue'

            export default {
                name: 'MyAccount',
                components: {
                    OrderSummary
                },
                data() {
                    return {
                        orders: []
                    }
                },
                mounted() {
                    document.title = 'My account | Djackets'

                    this.getMyOrders()
                },
                methods: {
                    ...
                    ,
                    async getMyOrders() {
                        this.$store.commit('setIsLoading', true)

                        await axios
                                .get(`/api/v1/orders/`)
                                .then(response => {
                                    this.orders = response.data
                                })
                                .catch(error => {
                                    console.log(error)
                                })

                        this.$store.commit('setIsLoading', false)
                    }
                }

    - An order should be a component

        ---> djackets_vue\src\components\OrderSummary.vue (NEW FILE)
            <template>
                <div class="box mb-4">
                    <h3 class="is-size-4 mb-6">Order #{{ order.id }}</h3>

                    <h4 class="is-size-5">Products</h4>

                    <table class="table is-fullwidth">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Price</th>
                                <th>Quantity</th>
                                <th>Total</th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr v-for="item in order.items" :key="item.product.id">
                                <td>{{ item.product.name }}</td>
                                <td>${{ item.product.price }}</td>
                                <td>{{ item.quantity }}</td>
                                <td>${{ getItemTotal(item).toFixed(2) }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </template>

            <script>
            export default {
                name: 'OrderSummary',
                props: {
                    order: Object
                },
                methods: {
                    getItemTotal(item) {
                        return item.quantity * item.product.price
                    },
                    orderTotalLength(order) {
                        return order.items.reduce((acc, curVal) => {
                            return acc += curVal.quantity
                        }, 0)
                    }
                }
            }
            </script>

- Deploy Django ==================== PENDING ===========================
    - Create a server and access it
    - Install software
    - Create Postgres DB
    - Create Users and Virtual Enviroment
    - Install packages and get project files
    - Create separate settingsfile for production
    - Set up Gunicorn
    - Set up Supervisor
    - Obtain SSI certificate